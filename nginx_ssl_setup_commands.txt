üåê –ù–ê–°–¢–†–û–ô–ö–ê NGINX –ò SSL –î–õ–Ø –î–û–ú–ï–ù–ê tournaments.sytes.net
============================================================

üìã –û–ë–ó–û–†:
–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Nginx –∫–∞–∫ reverse proxy –∏ –ø–æ–ª—É—á–µ–Ω–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
–¥–ª—è –¥–æ–º–µ–Ω–∞ tournaments.sytes.net

üéØ –î–û–ú–ï–ù: tournaments.sytes.net
üñ•Ô∏è –°–ï–†–í–ï–†: 45.135.164.202

üîß –≠–¢–ê–ü 1: –ü–†–û–í–ï–†–ö–ê –î–û–ú–ï–ù–ê
===========================

# –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS —Ä–µ–∑–æ–ª–≤–∏–Ω–≥–∞
nslookup tournaments.sytes.net
dig tournaments.sytes.net

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–æ–º–µ–Ω–∞
curl -I http://tournaments.sytes.net
ping tournaments.sytes.net

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –¥–æ–º–µ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–∞—à —Å–µ—Ä–≤–µ—Ä
host tournaments.sytes.net

üîß –≠–¢–ê–ü 2: –£–°–¢–ê–ù–û–í–ö–ê CERTBOT
=============================

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot
sudo apt install certbot python3-certbot-nginx -y

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
certbot --version

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–ª–∞–≥–∏–Ω–∞ nginx
certbot plugins

üîß –≠–¢–ê–ü 3: –ù–ê–°–¢–†–û–ô–ö–ê NGINX –î–õ–Ø –î–û–ú–ï–ù–ê
======================================

# –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –¥–æ–º–µ–Ω–∞
sudo nano /etc/nginx/sites-available/tournament-app

–°–û–î–ï–†–ñ–ò–ú–û–ï –§–ê–ô–õ–ê /etc/nginx/sites-available/tournament-app:
----------------------------------------------------------
server {
    listen 80;
    server_name tournaments.sytes.net;

    # –õ–æ–≥–∏
    access_log /var/log/nginx/tournament-app.access.log;
    error_log /var/log/nginx/tournament-app.error.log;

    # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    location / {
        proxy_pass http://localhost:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Port $server_port;
        
        # –¢–∞–π–º–∞—É—Ç—ã
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
    location /static/ {
        alias /home/tournament-admin/tournament-app/static/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Health check endpoint
    location /health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
}

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo ln -s /etc/nginx/sites-available/tournament-app /etc/nginx/sites-enabled/

# –£–¥–∞–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo rm -f /etc/nginx/sites-enabled/default

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º Nginx
sudo systemctl reload nginx

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
sudo systemctl status nginx

üîß –≠–¢–ê–ü 4: –ü–û–õ–£–ß–ï–ù–ò–ï SSL –°–ï–†–¢–ò–§–ò–ö–ê–¢–ê
=====================================

# –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
sudo certbot --nginx -d tournaments.sytes.net

–ò–ù–°–¢–†–£–ö–¶–ò–ò –î–õ–Ø CERTBOT:
------------------------
1. –í–≤–µ–¥–∏—Ç–µ email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ
2. –°–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (A)
3. –í—ã–±–µ—Ä–∏—Ç–µ redirect HTTP –Ω–∞ HTTPS (2)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
sudo certbot certificates

# –¢–µ—Å—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
sudo certbot renew --dry-run

üîß –≠–¢–ê–ü 5: –ü–†–û–í–ï–†–ö–ê SSL –ò NGINX
================================

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx
sudo nginx -t

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
sudo netstat -tlnp | grep :80
sudo netstat -tlnp | grep :443

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ HTTP
curl -I http://tournaments.sytes.net

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ HTTPS
curl -I https://tournaments.sytes.net

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
openssl s_client -connect tournaments.sytes.net:443 -servername tournaments.sytes.net

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ —Å HTTP –Ω–∞ HTTPS
curl -I http://tournaments.sytes.net

üîß –≠–¢–ê–ü 6: –ù–ê–°–¢–†–û–ô–ö–ê –ê–í–¢–û–û–ë–ù–û–í–õ–ï–ù–ò–Ø –°–ï–†–¢–ò–§–ò–ö–ê–¢–ê
================================================

# –°–æ–∑–¥–∞–µ–º cron –∑–∞–¥–∞—á—É –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
sudo crontab -e

# –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É (–≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –ø–æ –∂–µ–ª–∞–Ω–∏—é):
# 0 12 * * * /usr/bin/certbot renew --quiet

# –ò–ª–∏ —Å–æ–∑–¥–∞–µ–º systemd timer (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
sudo systemctl enable certbot.timer
sudo systemctl start certbot.timer

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å timer
sudo systemctl status certbot.timer

üîß –≠–¢–ê–ü 7: –ù–ê–°–¢–†–û–ô–ö–ê –§–ê–ô–†–í–û–õ–ê –î–õ–Ø HTTPS
========================================

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ñ–∞–π—Ä–≤–æ–ª–∞
sudo ufw status

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è HTTPS
sudo ufw allow 'Nginx Full'
sudo ufw allow OpenSSH

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
sudo ufw status verbose

üîß –≠–¢–ê–ü 8: –°–û–ó–î–ê–ù–ò–ï –¢–ï–°–¢–û–í–û–ì–û –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
=========================================

# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π Flask —Å–µ—Ä–≤–µ—Ä
sudo nano /home/tournament-admin/test_app.py

–°–û–î–ï–†–ñ–ò–ú–û–ï test_app.py:
-----------------------
from flask import Flask
app = Flask(__name__)

@app.route('/')
def hello():
    return '<h1>Tournament App is working!</h1><p>Domain: tournaments.sytes.net</p>'

@app.route('/health')
def health():
    return 'OK', 200

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Flask
pip3 install flask

# –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ
nohup python3 /home/tournament-admin/test_app.py > /dev/null 2>&1 &

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
ps aux | grep test_app

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
curl http://localhost:5000

üîß –≠–¢–ê–ü 9: –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê
==============================

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ HTTP (–¥–æ–ª–∂–µ–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—å –Ω–∞ HTTPS)
curl -I http://tournaments.sytes.net

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ HTTPS
curl -I https://tournaments.sytes.net

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# –û—Ç–∫—Ä–æ–π—Ç–µ https://tournaments.sytes.net –≤ –±—Ä–∞—É–∑–µ—Ä–µ

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–µ–ª–µ–Ω—ã–π –∑–∞–º–æ–∫

üìã –ß–ï–ö-–õ–ò–°–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø:
========================
- ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS —Ä–µ–∑–æ–ª–≤–∏–Ω–≥–∞ –¥–æ–º–µ–Ω–∞
- ‚è≥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot
- ‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx
- ‚è≥ –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚è≥ –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã HTTPS
- ‚è≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

üö® –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø:
=================================

1. –î–û–ú–ï–ù –ù–ï –†–ï–ó–û–õ–í–ò–¢–°–Ø
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ no-ip
- –ü–æ–¥–æ–∂–¥–∞—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è DNS (–¥–æ 24 —á–∞—Å–æ–≤)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å A-–∑–∞–ø–∏—Å—å –≤ no-ip

2. CERTBOT –ù–ï –ú–û–ñ–ï–¢ –ü–û–õ–£–ß–ò–¢–¨ –°–ï–†–¢–ò–§–ò–ö–ê–¢
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–æ–º–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTP
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π—Ä–≤–æ–ª (–ø–æ—Ä—Ç 80 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç

3. NGINX –ù–ï –ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: sudo nginx -t
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: sudo tail -f /var/log/nginx/error.log
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç—ã: sudo netstat -tlnp | grep nginx

4. SSL –°–ï–†–¢–ò–§–ò–ö–ê–¢ –ù–ï –†–ê–ë–û–¢–ê–ï–¢
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç: sudo certbot certificates
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx: sudo systemctl restart nginx

üéØ –°–õ–ï–î–£–Æ–©–ò–ï –≠–¢–ê–ü–´:
===================
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL:
1. –°–æ–∑–¥–∞–Ω–∏–µ Dockerfile –¥–ª—è Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –°–æ–∑–¥–∞–Ω–∏–µ docker-compose.yml
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Actions
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: $(date)
–í–µ—Ä—Å–∏—è: 1.0

