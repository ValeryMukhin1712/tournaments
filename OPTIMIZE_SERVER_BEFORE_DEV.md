# üîß –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º dev –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

–°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º:

- **–î–∏—Å–∫**: 6.9GB –≤—Å–µ–≥–æ, 5.2GB –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ, **1.3GB —Å–≤–æ–±–æ–¥–Ω–æ (80% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ)**
- **RAM**: 961MB –≤—Å–µ–≥–æ, 525MB –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ, **435MB –¥–æ—Å—Ç—É–ø–Ω–æ**

## ‚ö†Ô∏è –ê–Ω–∞–ª–∏–∑ —Å–∏—Ç—É–∞—Ü–∏–∏

### –î–∏—Å–∫ (80% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ)
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (–Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- **–î–ª—è dev –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ**: ~500MB
- **–î–æ—Å—Ç—É–ø–Ω–æ**: 1.3GB
- **–í—ã–≤–æ–¥**: ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞, –Ω–æ –ª—É—á—à–µ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –µ—â–µ –Ω–µ–º–Ω–æ–≥–æ

### RAM (961MB –≤—Å–µ–≥–æ)
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- **–î–ª—è dev –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ**: ~200-300MB –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
- **–î–æ—Å—Ç—É–ø–Ω–æ**: 435MB
- **–í—ã–≤–æ–¥**: ‚ö†Ô∏è –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å, –Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º dev

### 1. –û—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

#### –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤ (–º–æ–∂–µ—Ç –æ—Å–≤–æ–±–æ–¥–∏—Ç—å 100-500MB):

```bash
# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ –∂—É—Ä–Ω–∞–ª–∞ (–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π)
sudo journalctl --vacuum-time=7d

# –ò–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤ –¥–æ 100MB
sudo journalctl --vacuum-size=100M

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤
sudo journalctl --disk-usage
```

#### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø–∞–∫–µ—Ç–æ–≤:

```bash
# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à apt
sudo apt clean

# –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã
sudo apt autoremove

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ
df -h /
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä production –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
du -sh ~/quick-score/instance/tournament.db

# –ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ—á–µ–Ω—å –±–æ–ª—å—à–∞—è (>500MB), –º–æ–∂–Ω–æ:
# - –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç—É—Ä–Ω–∏—Ä—ã
# - –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
```

#### –ü–æ–∏—Å–∫ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤:

```bash
# –ù–∞–π—Ç–∏ —Å–∞–º—ã–µ –±–æ–ª—å—à–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –¥–æ–º–∞—à–Ω–µ–π –ø–∞–ø–∫–µ
du -sh ~/* | sort -h | tail -10

# –ù–∞–π—Ç–∏ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (>50MB)
find ~ -type f -size +50M 2>/dev/null

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤ Nginx
sudo du -sh /var/log/nginx/*
```

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RAM

#### –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ workers –≤ production:

```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–∏—Å–∞
sudo nano /etc/systemd/system/tournaments.service
```

–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å `--workers` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:
```ini
# –ë—ã–ª–æ (–µ—Å–ª–∏ –±—ã–ª–æ 4):
--workers 4

# –°—Ç–∞–Ω–µ—Ç:
--workers 2
```

–ó–∞—Ç–µ–º:
```bash
sudo systemctl daemon-reload
sudo systemctl restart tournaments
```

#### –î–ª—è dev –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–Ω–∏–º—É–º workers:

–í —Ñ–∞–π–ª–µ `deployment/systemd/tournaments-dev.service` —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
```ini
--workers 2
```

–ú–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 1 –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏:
```ini
--workers 1
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ swap (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–∏–π swap:
```bash
free -h
```

–ï—Å–ª–∏ swap –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ (–∫–∞–∫ –≤ –≤–∞—à–µ–º —Å–ª—É—á–∞–µ - 25MB), —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. 
–ù–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π swap
swapon --show

# –ï—Å–ª–∏ swap —Ñ–∞–π–ª–∞ –Ω–µ—Ç, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å 511MB)
```

## üìã –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –û—á–∏—Å—Ç–∫–∞ (–≤—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

```bash
# 1. –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
sudo journalctl --vacuum-time=7d

# 2. –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
sudo apt clean
sudo apt autoremove

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
df -h /
free -h
```

### –®–∞–≥ 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è production —Å–µ—Ä–≤–∏—Å–∞

```bash
# –£–º–µ–Ω—å—à–∏—Ç—å workers
sudo nano /etc/systemd/system/tournaments.service
# –ò–∑–º–µ–Ω–∏—Ç–µ --workers –Ω–∞ 2 (–∏–ª–∏ 1, –µ—Å–ª–∏ –±—ã–ª–æ 4)

sudo systemctl daemon-reload
sudo systemctl restart tournaments

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
sudo systemctl status tournaments
```

### –®–∞–≥ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ dev –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å dev –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ dev
~/setup_dev_environment.sh
```

**–í–∞–∂–Ω–æ**: –í —Å–∫—Ä–∏–ø—Ç–µ `setup_dev_environment.sh` —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `tournaments-dev.service` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `--workers 1` –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏.

### –®–∞–≥ 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
~/check_server_resources.sh

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
watch -n 5 'free -h && df -h /'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl status tournaments
sudo systemctl status tournaments-dev
```

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤ –∏ –∫—ç—à–∞ –≤—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å:
- **–î–∏—Å–∫**: ~1.5-2GB —Å–≤–æ–±–æ–¥–Ω–æ (–≤–º–µ—Å—Ç–æ 1.3GB)
- **RAM**: ~450-500MB –¥–æ—Å—Ç—É–ø–Ω–æ (–ø–æ—Å–ª–µ —É–º–µ–Ω—å—à–µ–Ω–∏—è workers)

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è dev –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- **–î–∏—Å–∫**: ~1-1.5GB —Å–≤–æ–±–æ–¥–Ω–æ (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
- **RAM**: ~200-300MB –¥–æ—Å—Ç—É–ø–Ω–æ (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ, –Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è dev –≤–µ—Ä—Å–∏–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
2. **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ dev**: –ï—Å–ª–∏ dev –≤–µ—Ä—Å–∏—è –Ω–µ –Ω—É–∂–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å:
   ```bash
   sudo systemctl stop tournaments-dev
   ```
3. **–û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É –ª–æ–≥–æ–≤:
   ```bash
   sudo nano /etc/systemd/journald.conf
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: SystemMaxUse=100M
   sudo systemctl restart systemd-journald
   ```

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ —Ä–µ—Å—É—Ä—Å–æ–≤

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è dev –≤–µ—Ä—Å–∏–∏ —Ä–µ—Å—É—Ä—Å—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è:

1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å dev –≤–µ—Ä—Å–∏—é:**
   ```bash
   sudo systemctl stop tournaments-dev
   sudo systemctl disable tournaments-dev
   ```

2. **–û—á–∏—Å—Ç–∏—Ç—å –º–µ—Å—Ç–æ:**
   ```bash
   sudo journalctl --vacuum-size=50M
   sudo apt clean
   ```

3. **–£–º–µ–Ω—å—à–∏—Ç—å workers:**
   ```bash
   # –í –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å --workers 1
   ```

## üìä –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `check_server_resources.sh` –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00)
crontab -e
# –î–æ–±–∞–≤–∏—Ç—å:
0 9 * * * /home/deploy/check_server_resources.sh >> /home/deploy/resources_check.log 2>&1
```

---

**–í—ã–≤–æ–¥**: –í–∞—à —Å–µ—Ä–≤–µ—Ä –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ, –Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è dev –æ–∫—Ä—É–∂–µ–Ω–∏—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é (–æ—á–∏—Å—Ç–∫—É –ª–æ–≥–æ–≤ –∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ workers), –∞ –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–∏—Ç—å dev –≤–µ—Ä—Å–∏—é —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (1 worker).

